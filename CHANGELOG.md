# Changelog
All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](http://keepachangelog.com/en/1.0.0/)
and this project adheres to [Semantic Versioning](http://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added
- The app.json application manifest for Heroku deployment.

### Changed
- Licensed under GNU Affero General Public License version 3 or above.
- Heroku's python runtime updated to 3.7.7


## [0.9.2] - 2019-01-18

### Added
- Добавлен фильтр `is_actial` для фильтрации актуальных предложений.
- На картах и списках предложений `in_bbox` фильтр (bounding box).
- Добавлено поле `metadata` для файлов и вложенное поле `duration`.

### Changed
- Вебсокет-сервер добавлен для удобства как подмодуль главной репы.
- Только пользователи в статусе "онлайн" отображаются на картах и в списках.
- Исправлены фильтры `user__uuid` и `user__uuid__ne` (фильтрация по user uuid).
- Проверка минимального баланса на SMS.ru с уведомлением в лог.
- Добавлены данные пользователя в карточку предложения.
- Статика отдается с помощью WhiteNoise.
- Включена настройка `ATOMIC_REQUESTS` в общем конфиге.


## [0.9.1] - 2018-11-28

### Added
- Кастомный обработчик для исключений в DRF (пока отключен - может с sentry нахнужен).
- В JWT-токен в пейлоад добавляются uuid и phone.
- Отправка sms кода через SMS-gateway.
- Возможность принудительного закрытия сессии через /login.
- Добавлена ограничение на уровне объектов.
- Глобально включена авторизация.
- Загрузка файлов через pre-signed URL.
- Добавлен билд-стейдж flake8.

### Changed
- Dockerfile и Compose соответсвует новой схеме деплоя.
- Убраные методы PUT там где они не использовались.
- Больше документированных полей.
- Добавлен флаг "сообщение удалено для себя".
- Добавлена возможность ссылаться в сообщении на другое сообщение.
- Добавлена возможность включать/выключать уведомления в чате.
- Функциональность модуля "Авторизация".
- Функциональнсоть модуля "Контакты".
- Добавлена мидлеварь JWTAuthenticationMiddleware: небольшой костыль, что бы
 инициализировать request.user из JWT-токена.
- Добавлена мидльварь RestrictBlockedUsersMiddleware: возращает код 423 Locked
  для всех запросов от заблокированного пользователя.
- CRUD для модуля "Контакты".
- Возможность регистрировать пользователей списком - используется для импорта
  телефонной книги пользователя.
- Время жизни токена установлено в 30 дней по условиям ТЗ.
- Вьюсет registration отрефакторен в init.
- Удаление неискользуемых HTTP-методов.
- Очередь переведа на AMQP/RabbitMQ, так же для PUSH и media отдельные очереди.
- Оптимизация процесса CI/CD (все пайплайны сейчас запускаются на офисном сервере).
- Отрефакторены СМС-коды: теперь это отдельная таблица-объект.


## [0.0.2]

### Added
- Поддержка Heroku - можно задеплоить приложение через `make herokuapp`.
- Начальная поддержка PostGIS - поднимается прямо из миграций Django.
- Новая команда `make check` - выводит отладочную информацию.

### Changed
- Dockerfile переведен на Heroku-16 и билдпаки - билд геобиблиотек из коробки.
- Все Datetime сериализиуются в обе стороны unixt timestamp c микросекундамию.
